<!DOCTYPE html>
<html lang="en">
	<head>
		<title>three.js webgl - Toki Japanese Highball</title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0">
		<link type="text/css" rel="stylesheet" href="./examples/example.css">
		<!-- Adobe Fonts - Futura PT -->
		<link rel="stylesheet" href="https://use.typekit.net/rfm8mfq.css">
		<style>
			@import url('https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@300;400;500&family=Cormorant+Garamond:wght@400;500&display=swap');

			html, body {
				margin: 0;
				padding: 0;
				width: 100%;
				height: 100%;
				overflow: hidden;
			}

			body {
				font-family: "futura-pt", sans-serif;
				font-weight: 400;
				font-style: normal;
				background: #0a0a0a url('./images/mr-background.jpg') center center / cover no-repeat;
			}

      #info {
        display: none; /* Hidden per user request */
      }

			#info .title-wrapper span {
				color: #7ec8e8;
				font-family: 'Cormorant Garamond', serif;
				font-weight: 500;
				letter-spacing: 1px;
			}

			#info .title-wrapper a {
				color: #ffffff;
			}

			#info small {
				color: rgba(255, 255, 255, 0.7);
			}

		#drinkControls {
			display: none; /* Moved to GUI panel */
		}

			#drinkControls h3 {
				margin: 0 0 16px 0;
				font-size: 15px;
				font-weight: 500;
				color: #7ec8e8;
				letter-spacing: 1px;
				font-family: 'Cormorant Garamond', serif;
				text-transform: uppercase;
			}

			.control-row {
				display: flex;
				align-items: center;
				justify-content: space-between;
				margin-bottom: 14px;
			}

			.control-row:last-child {
				margin-bottom: 0;
			}

			.control-row label {
				color: rgba(255, 255, 255, 0.8);
				font-size: 12px;
				min-width: 70px;
			}

			.control-row .controls {
				display: flex;
				align-items: center;
				gap: 8px;
			}

			#drinkControls button {
				background: rgba(126, 200, 232, 0.15);
				border: 1px solid rgba(126, 200, 232, 0.4);
				color: #7ec8e8;
				padding: 6px 12px;
				border-radius: 8px;
				cursor: pointer;
				font-size: 12px;
				font-weight: 500;
				transition: all 0.2s ease;
				font-family: inherit;
			}

			#drinkControls button:hover {
				background: rgba(126, 200, 232, 0.25);
				border-color: rgba(126, 200, 232, 0.6);
			}

			#drinkControls button:active {
				transform: scale(0.96);
			}

			#drinkControls button.active {
				background: rgba(126, 200, 232, 0.35);
				border-color: #7ec8e8;
			}

			#fizzValue {
				min-width: 32px;
				text-align: center;
				font-weight: 500;
				color: #ffffff;
			}

			.slider-control {
				width: 70px;
				height: 4px;
				-webkit-appearance: none;
				appearance: none;
				background: rgba(126, 200, 232, 0.25);
				border-radius: 2px;
				outline: none;
				cursor: pointer;
			}

			.slider-control::-webkit-slider-thumb {
				-webkit-appearance: none;
				appearance: none;
				width: 14px;
				height: 14px;
				background: #7ec8e8;
				border-radius: 50%;
				cursor: pointer;
				transition: transform 0.15s ease;
			}

			.slider-control::-webkit-slider-thumb:hover {
				transform: scale(1.15);
			}

			.slider-control::-moz-range-thumb {
				width: 14px;
				height: 14px;
				background: #7ec8e8;
				border: none;
				border-radius: 50%;
				cursor: pointer;
			}

			/* Hotspot Info Panel Styles */
			.hotspot-panel {
				position: fixed;
				top: 50%;
				left: 50%;
				transform: translate(-50%, -50%) scale(0.9);
				background: rgba(242, 238, 230, 0.9);
				border-radius: 0px;
				padding: 32px 40px;
				color: #000000;
				font-family: "futura-pt", sans-serif;
				font-weight: 400;
				font-style: normal;
				backdrop-filter: blur(16px);
				z-index: 200;
				max-width: 420px;
				width: 70%;
				opacity: 0;
				visibility: hidden;
				transition: all 0.35s cubic-bezier(0.4, 0, 0.2, 1);
				box-shadow: 0 25px 60px rgba(0, 0, 0, 0.4);
			}

			.hotspot-panel.active {
				opacity: 0.9;
				visibility: visible;
				transform: translate(-50%, -50%) scale(1);
			}

			.hotspot-panel-header {
				display: flex;
				justify-content: end;
				align-items: flex-start;
				margin-bottom: 20px;
			}

			.hotspot-panel h2 {
				margin: 0;
				font-family: 'Cormorant Garamond', serif;
				font-size: 26px;
				font-weight: 500;
				color: #000000;
				letter-spacing: 1px;
			}

		.hotspot-panel-close {
			color: #000000;
			width: 36px;
			height: 36px;
			border-radius: 50%;
			cursor: pointer;
			font-size: 20px;
			display: flex;
			align-items: center;
			justify-content: center;
			transition: all 0.2s ease;
			flex-shrink: 0;
			margin-left: 16px;
			background: transparent;
			border: none;
		}

		.hotspot-panel-close:hover {
			opacity: 0.7;
			transform: scale(1.1);
		}

			.hotspot-panel p {
				margin: 0 0 16px 0;
				font-size: 14px;
				line-height: 1.7;
				color: #000000;
			}

			.hotspot-panel p:last-child {
				margin-bottom: 0;
			}

			.hotspot-panel .highlight {
				color: #dbb85c;
				font-weight: 500;
			}

			.hotspot-panel video {
				width: 100%;
				border-radius: 0px;
				border: 0.852px solid #CD2A1E;
				background: #000;
			}

			.hotspot-panel .video-placeholder {
				width: 100%;
				aspect-ratio: 16/9;
				background: linear-gradient(135deg, rgba(126, 200, 232, 0.15), rgba(219, 184, 92, 0.15));
				border-radius: 12px;
				margin-top: 16px;
				display: flex;
				flex-direction: column;
				align-items: center;
				justify-content: center;
				border: 1px dashed rgba(126, 200, 232, 0.3);
			}

			.hotspot-panel .video-placeholder svg {
				width: 48px;
				height: 48px;
				fill: rgba(126, 200, 232, 0.6);
				margin-bottom: 12px;
			}

		.hotspot-panel .video-placeholder span {
			font-size: 12px;
			color: rgba(255, 255, 255, 0.5);
		}

		.hotspot-panel .bento-top {
			padding: 25px 35px;
			border: 0.852px solid #CD2A1E;
		}

		.hotspot-panel .bento-top-split {
			display: flex;
			justify-content: space-between;
			align-items: center;
			padding: 0px 15px;
			border: 0.852px solid #CD2A1E;
		}

		.hotspot-panel .bento-top-split .enso-left {
			width: 50%;
			border-right: 0.852px solid #CD2A1E;
		}
		.hotspot-panel .bento-top-split .enso-left h3 {
			color: #000;
			font-size: 19.078px;
			font-style: normal;
			font-weight: 450;
			line-height: normal;
			letter-spacing: 1.717px;
			text-transform: uppercase;
			margin: 35px 0px;
			text-align: center;
		}
		.hotspot-panel .bento-top-split .enso-right {
			width: 50%;
		}
		.hotspot-panel .bento-top-split .enso-right h4 {
			color: #CD2A1E;
			text-align: center;
			font-family: "futura-pt", sans-serif;
			font-size: 12px;
			font-style: normal;
			font-weight: 400;
			line-height: normal;
			letter-spacing: 0.36px;
			text-transform: uppercase;
		}

		.hotspot-panel .bento-top-split .left {
			border-right: 0.852px solid #CD2A1E;
			width: 60%;
		}
		.hotspot-panel .bento-top-split .left h3 {
			color: #000;
			font-size: 19.078px;
			font-style: normal;
			font-weight: 450;
			line-height: normal;
			letter-spacing: 1.717px;
			text-transform: uppercase;
			margin: 35px 0px;
			text-align: center;
		}
		.hotspot-panel .bento-top-split .right {
			width: 40%;
		}
		.hotspot-panel .bento-top-split .right p {
			color: #231815;
			font-size: 9.085px;
			font-style: normal;
			font-weight: 400;
			line-height: 12.492px; /* 137.5% */
			letter-spacing: 0.182px;
			padding-left: 18px;
		}

		.hotspot-panel .bento-bottom {
			display: flex;
			justify-content: space-between;
			align-items: center;
			border: 0.852px solid #CD2A1E;
			gap: 12px;
		}
		.hotspot-panel .bento-bottom-left {
			border-right: 0.852px solid #CD2A1E;
		}
		.hotspot-panel .bento-bottom-right p {
			color: #231815;
			font-size: 9.085px;
			font-style: normal;
			font-weight: 400;
			line-height: 12.492px; /* 137.5% */
			letter-spacing: 0.182px;
		}

		.hotspot-panel .bento-bottom .enso-left {
			width: 40%;
			border-right: 0.852px solid #CD2A1E;
		}
		.hotspot-panel .bento-bottom .enso-left h4 {
			color: #CD2A1E;
			font-family: "futura-pt", sans-serif;
			font-size: 12px;
			font-style: normal;
			font-weight: 400;
			line-height: normal;
			letter-spacing: 0.36px;
			text-transform: uppercase;
			margin: 40px 20px;
		}
		.hotspot-panel .bento-bottom .enso-right {
			width: 60%;
		}
		.hotspot-panel .bento-bottom .enso-right p {
			color: #231815;
			font-size: 9.085px;
			font-style: normal;
			font-weight: 400;
			line-height: 12.492px; /* 137.5% */
			letter-spacing: 0.182px;
			margin: 20px 10px;
		}

		#panelVideo h3 {
			font-family: "futura-pt", sans-serif;
			font-weight: 500;
			font-style: normal;
			font-size: 15px;
			leading-trim: none;
			line-height: 100%;
			letter-spacing: 0.05em;
			text-align: center;
			text-transform: uppercase;
		}

			.hotspot-overlay {
				position: fixed;
				top: 0;
				left: 0;
				width: 100%;
				height: 100%;
				background: rgba(0, 0, 0, 0.5);
				z-index: 150;
				opacity: 0;
				visibility: hidden;
				transition: all 0.35s ease;
			}

			.hotspot-overlay.active {
				opacity: 0.8;
				visibility: visible;
			}

			/* Hotspot Label Tooltips */
			.hotspot-label {
				position: fixed;
				background: rgba(20, 40, 60, 0.9);
				border: 1px solid rgba(126, 200, 232, 0.4);
				border-radius: 8px;
				padding: 8px 14px;
				color: #7ec8e8;
				font-family: "futura-pt", sans-serif;
				font-size: 12px;
				font-weight: 500;
				font-style: normal;
				pointer-events: none;
				z-index: 120;
				opacity: 0;
				transform: translateY(8px);
				transition: all 0.25s ease;
				white-space: nowrap;
				backdrop-filter: blur(8px);
			}

		.hotspot-label.visible {
			opacity: 1;
			transform: translateY(0);
		}

		#ensoCanvasContainer {
			margin: 0 !important;
		}

		#ensoCanvasContainer canvas {
			border: 0.852px solid #CD2A1E;
		}

		#ensoProgress {
			position: absolute;
			bottom: 150px;
			width: 250px;
			left: 70px;
			margin: 0 auto;
		}

		/* lil-gui styling */
		.lil-gui {
			--width: 320px;
			--background-color: rgba(20, 40, 60, 0.92);
			--widget-color: rgba(126, 200, 232, 0.3);
			--hover-color: rgba(126, 200, 232, 0.5);
			--focus-color: rgba(126, 200, 232, 0.6);
			--number-color: #7ec8e8;
			--string-color: #7ec8e8;
			--font-size: 12px;
			--input-font-size: 12px;
			--font-family: "futura-pt", sans-serif;
			--padding: 8px;
			--spacing: 6px;
			--title-height: 32px;
			--title-background-color: rgba(126, 200, 232, 0.15);
			--title-text-color: #7ec8e8;
			--widget-height: 24px;
			--border-color: rgba(126, 200, 232, 0.3);
			--border-radius: 8px;
			z-index: 1000;
			backdrop-filter: blur(12px);
		}

		.lil-gui.root {
			position: fixed;
			top: 20px;
			right: 20px;
			max-height: calc(100vh - 40px);
			overflow-y: auto;
			overflow-x: hidden;
		}

		/* Ensure GUI content doesn't overflow */
		.lil-gui .children {
			max-height: calc(100vh - 100px);
			overflow-y: auto;
		}

	/* Keyboard shortcuts hint - HIDDEN */
	#keyboardHints {
		display: none !important;
	}

	</style>
	</head>
	<body>

	<!-- Hotspot Overlay -->
		<div id="hotspotOverlay" class="hotspot-overlay" role="presentation"></div>

		<!-- Hotspot Info Panels -->
		<div id="panelHowToMake" class="hotspot-panel" role="dialog" aria-labelledby="panelHowToMake" aria-modal="true">
			<div class="hotspot-panel-header">
				<button class="hotspot-panel-close" aria-label="Close panel" tabindex="0">×</button>
			</div>
			<div class="bento-top-split">
				<div class="left">
					<h3>MAKE YOUR<br>OWN HIGHBALL</h3>
				</div>
				<div class="right">
					<p>
						Follow the steps to craft the perfect highball the Japanese way.
					</p>
				</div>
			</div>
			<img src="./images/assets/makeyourown.jpg" alt="Make Your Own Highball" width="100%" height="auto" />
		</div>

		<div id="panelIce" class="hotspot-panel" role="dialog" aria-labelledby="panelIceTitle" aria-modal="true">
			<div class="hotspot-panel-header">
				<button class="hotspot-panel-close" aria-label="Close panel" tabindex="0">×</button>
			</div>
			<img src="./images/assets/icecarving.jpg" alt="About Toki" width="100%" height="auto" />
			<div class="bento-bottom">
				<div class="bento-bottom-left">
					<h3>ICE<br>CARVING<br>GAME</h3>
				</div>
				<div class="bento-bottom-right">
					<p>Try the Japanese art of ice carving for an effervescent Toki Highball. </p>
				</div>
			</div>
		</div>

		<div id="panelVideo" class="hotspot-panel" role="dialog" aria-labelledby="panelVideoTitle" aria-modal="true">
			<div class="hotspot-panel-header">
				<button class="hotspot-panel-close" aria-label="Close panel" tabindex="0">×</button>
			</div>
			<div class="bento-top">
				<h3>MAKING A<br>TOKI HIGHBALL</h3>
			</div>
			<video 
				id="perfectServeVideo"
				src="./images/perfect-serve.mp4"
				controls
				playsinline
				preload="metadata"
			>
				Your browser does not support the video tag.
			</video>
			<div class="bento-bottom">
				<div class="bento-bottom-left" style="background: rgba(242, 238, 230, 1);">
					<img src="./images/assets/suntory-box-logo.png" alt="Suntory Box Logo" />
				</div>
				<div class="bento-bottom-right">
					<p>
						Toki presents a unique balance of subtle sweetness, citrusy freshness, 
						and a hint of spice. Its delightful aromas of green apple, along with 
						a nuanced pepper and ginger finish, make it the ideal 
						whisky for a refreshing highball.
					</p>
				</div>
			</div>
		</div>

		<div id="panelEnso" class="hotspot-panel hotspot-panel--enso" role="dialog" aria-labelledby="panelEnsoTitle" aria-modal="true">
			<div class="hotspot-panel-header">
				<button class="hotspot-panel-close" aria-label="Close panel" tabindex="0">×</button>
			</div>
			<div class="bento-top-split">
				<div class="enso-left">
					<h3>TOKI</h3>
				</div>
				<div class="enso-right">
					<h4>The Art of Calligraphy</h4>
				</div>
			</div>
			<div id="ensoCanvasContainer" style="width: 100%; height: 300px; margin: 16px 0; background: #F5F0E8; border-radius: 4px;"></div>
			<div id="ensoProgress" style="margin-top: 12px;">
				<div style="width: 100%; height: 4px; background: rgba(74, 63, 53, 0.2); border-radius: 2px; overflow: hidden; margin-bottom: 8px;">
					<div id="ensoProgressFill" style="height: 100%; background: #CD2A1E; border-radius: 2px; width: 0%; transition: width 0.3s ease;"></div>
				</div>
				<div id="ensoProgressText" style="font-size: 11px; text-align: center; color: #CD2A1E; text-transform: uppercase; letter-spacing: 1px;">Trace the path</div>
			</div>
			<div class="bento-bottom">
				<div class="enso-left">
					<h4>WRITE THE KANJI</h4>
				</div>
				<div class="enso-right">
					<p>
						Follow the stroke order to write the character. 
						Toki means 'time' in Japanese, a reference to 
						the way Toki balances tradition and innovation.
					</p>
				</div>
			</div>
		</div>

		<!-- Hotspot Label Tooltip -->
		<div id="hotspotLabel" class="hotspot-label"></div>

		<script type="importmap">
			{
				"imports": {
					"three": "./build/three.module.js",
					"three/addons/": "./lib/jsm/"
				}
			}
		</script>

		<script type="module" src="./src/js/toki/main.js"></script>
		
		<script>
			// Listen for AR start messages from parent window
			window.addEventListener('message', async (event) => {
				if (event.data?.type === 'startAR') {
					// Wait for main.js to load and expose startARSession
					const maxWait = 5000;
					const startTime = Date.now();
					
					const checkAndStart = () => {
						if (window.startARSession) {
							window.startARSession();
						} else if (Date.now() - startTime < maxWait) {
							setTimeout(checkAndStart, 100);
						}
					};
					
					checkAndStart();
				}
			});
		</script>
	</body>
</html>
